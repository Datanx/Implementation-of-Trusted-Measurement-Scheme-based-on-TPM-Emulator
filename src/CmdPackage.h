#ifndef	IN
#define IN
#endif

#ifndef OUT
#define OUT
#endif

#ifndef CMDPACKAGE_H
#define CMDPACKAGE_H

/////////Definition of Communication Command Code///////////
#define CMD_MJ_NULL					0x0000
#define CMD_MN_NULL					0x0000
////==============Request Cmd Code==============////
////Major Code////
#define CMD_MJ_REQ_HWINFO			0x0010
#define CMD_MJ_REQ_SWINFO			0x0011
#define CMD_MJ_REQ_EXEC_OSSTART_POLICY	0x0012
#define CMD_MJ_REQ_EXEC_SHELL_CMD	0x0013          //Execute shell command at agent (SINGLE DIRECTION COMMAND)
#define CMD_MJ_REQ_COMMCLOSE		0x0001		//Close communication between Agent & Server (SINGLE DIRECTION COMMAND)

////Hardware Minor Code////
#define CMD_MN_REQ_CPUINFO			0x0010
#define CMD_MN_REQ_CPUMD5HASH		0x0011
#define CMD_MN_REQ_CPUSHA1HASH		0x0012

#define CMD_MN_REQ_MEMINFO			0x0020
#define CMD_MN_REQ_MEMMD5HASH		0x0021
#define CMD_MN_REQ_MEMSHA1HASH		0x0022
#define CMD_MN_REQ_MEMNUM			0x0023

#define CMD_MN_REQ_HDDINFO			0x0030
#define CMD_MN_REQ_HDDMD5HASH		0x0031
#define CMD_MN_REQ_HDDSHA1HASH		0x0032

#define CMD_MN_REQ_USBINFO			0x0040
#define CMD_MN_REQ_USBMD5HASH		0x0041
#define CMD_MN_REQ_USBSHA1HASH		0x0042
#define CMD_MN_REQ_USBNUM			0x0043

#define CMD_MN_REQ_NICINFO			0x0050
#define CMD_MN_REQ_NICMD5HASH		0x0051
#define CMD_MN_REQ_NICSHA1HASH		0x0052
#define CMD_MN_REQ_NICNUM			0x0053

#define CMD_MN_REQ_PCINFO			0x0060
#define CMD_MN_REQ_PCMD5HASH		0x0061
#define CMD_MN_REQ_PCSHA1HASH		0x0062

#define CMD_MN_REQ_BIOSINFO			0x0070
#define CMD_MN_REQ_BIOSMD5HASH		0x0071
#define CMD_MN_REQ_BIOSSHA1HASH		0x0072

#define CMD_MN_REQ_MBINFO			0x0080
#define CMD_MN_REQ_MBMD5HASH		0x0081
#define CMD_MN_REQ_MBSHA1HASH		0x0082

////Software Minor Code////
#define CMD_MN_REQ_OSINFO			0x0110
#define CMD_MN_REQ_OSMD5HASH		0x0111
#define CMD_MN_REQ_OSSHA1HASH		0x0112

#define CMD_MN_REQ_KERNELINFO			0x0120
#define CMD_MN_REQ_KERNELMD5HASH		0x0121
#define CMD_MN_REQ_KERNELSHA1HASH		0x0122

#define CMD_MN_REQ_GCCINFO			0x0130
#define CMD_MN_REQ_GCCMD5HASH		0x0131
#define CMD_MN_REQ_GCCSHA1HASH		0x0132

#define CMD_MN_REQ_BASHINFO			0x0140
#define CMD_MN_REQ_BASHMD5HASH		0x0141
#define CMD_MN_REQ_BASHSHA1HASH		0x0142

#define CMD_MN_REQ_OPENOFFICEINFO			0x0150
#define CMD_MN_REQ_OPENOFFICEMD5HASH		0x0151
#define CMD_MN_REQ_OPENOFFICESHA1HASH		0x0152

#define CMD_MN_REQ_FIREFOXINFO			0x0160
#define CMD_MN_REQ_FIREFOXMD5HASH		0x0161
#define CMD_MN_REQ_FIREFOXSHA1HASH		0x0162


////==============Trans Cmd Code==============////
////Major Code////
#define CMD_MJ_TRN_HWINFO			0x0510
#define CMD_MJ_TRN_SWINFO			0x0511
#define CMD_MJ_TRN_EXEC_OSSTART_POLICY	0x0512

////Hardware Minor Code////
#define CMD_MN_TRN_CPUINFO			0x0510
#define CMD_MN_TRN_CPUMD5HASH		0x0511
#define CMD_MN_TRN_CPUSHA1HASH		0x0512

#define CMD_MN_TRN_MEMINFO			0x0520
#define CMD_MN_TRN_MEMMD5HASH		0x0521
#define CMD_MN_TRN_MEMSHA1HASH		0x0522
#define CMD_MN_TRN_MEMNUM			0x0523

#define CMD_MN_TRN_HDDINFO			0x0530
#define CMD_MN_TRN_HDDMD5HASH		0x0531
#define CMD_MN_TRN_HDDSHA1HASH		0x0532

#define CMD_MN_TRN_USBINFO			0x0540
#define CMD_MN_TRN_USBMD5HASH		0x0541
#define CMD_MN_TRN_USBSHA1HASH		0x0542
#define CMD_MN_TRN_USBNUM			0x0543

#define CMD_MN_TRN_NICINFO			0x0550
#define CMD_MN_TRN_NICMD5HASH		0x0551
#define CMD_MN_TRN_NICSHA1HASH		0x0552
#define CMD_MN_TRN_NICNUM			0x0553

#define CMD_MN_TRN_PCINFO			0x0560
#define CMD_MN_TRN_PCMD5HASH		0x0561
#define CMD_MN_TRN_PCSHA1HASH		0x0562

#define CMD_MN_TRN_BIOSINFO			0x0570
#define CMD_MN_TRN_BIOSMD5HASH		0x0571
#define CMD_MN_TRN_BIOSSHA1HASH		0x0572

#define CMD_MN_TRN_MBINFO			0x0580
#define CMD_MN_TRN_MBMD5HASH		0x0581
#define CMD_MN_TRN_MBSHA1HASH		0x0582

////Software Minor Code////
#define CMD_MN_TRN_OSINFO			0x0610
#define CMD_MN_TRN_OSMD5HASH		0x0611
#define CMD_MN_TRN_OSSHA1HASH		0x0612

#define CMD_MN_TRN_KERNELINFO			0x0620
#define CMD_MN_TRN_KERNELMD5HASH		0x0621
#define CMD_MN_TRN_KERNELSHA1HASH		0x0622

#define CMD_MN_TRN_GCCINFO			0x0630
#define CMD_MN_TRN_GCCMD5HASH		0x0631
#define CMD_MN_TRN_GCCSHA1HASH		0x0632

#define CMD_MN_TRN_BASHINFO			0x0640
#define CMD_MN_TRN_BASHMD5HASH		0x0641
#define CMD_MN_TRN_BASHSHA1HASH		0x0642

#define CMD_MN_TRN_OPENOFFICEINFO			0x0650
#define CMD_MN_TRN_OPENOFFICEMD5HASH		0x0651
#define CMD_MN_TRN_OPENOFFICESHA1HASH		0x0652

#define CMD_MN_TRN_FIREFOXINFO			0x0660
#define CMD_MN_TRN_FIREFOXMD5HASH		0x0661
#define CMD_MN_TRN_FIREFOXSHA1HASH		0x0662


//Definition of Cmd Package
typedef struct _CMD_PACKAGE
{
	char RcgCode[32];	//Recoganize Code of Package
	unsigned short CMD_MJ_CODE;
	unsigned short CMD_MN_CODE;
	void *DataBuf;
	int DataBufLen;
	void *Extension;
	int ExtensionLen;
} CMD_PACKAGE, *PCMD_PACKAGE;

void CmdPack_Init(IN PCMD_PACKAGE pkg);

void CmdPack_Free(IN PCMD_PACKAGE pkg);

int CmdPack_IsPkgValid(IN PCMD_PACKAGE pkg);

int CmdPack_IsMsgValid(IN char *msg);

char* CmdPack_Serialize(OUT int *out_msg_len, IN PCMD_PACKAGE pkg);

void CmdPack_Unserialize(IN PCMD_PACKAGE pkg, IN char *in_msg);
#endif
